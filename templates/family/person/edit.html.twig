{% extends 'base.html.twig' %}

{% block title %}Modifier {{ person.firstname }}{% endblock %}

{% block body %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-7">
            
            {# --- NAVIGATION DISCRÈTE --- #}
            <nav class="mb-4">
                <a href="{{ path('app_family_dashboard') }}" class="text-decoration-none text-muted small fw-bold hover-translate-x d-inline-flex align-items-center">
                    <i class="fas fa-arrow-left me-2"></i>RETOUR À LA FAMILLE
                </a>
            </nav>

            {# --- HEADER ÉPURÉ --- #}
            <div class="text-center mb-5">
                <div class="edit-badge mb-3">
                    <i class="fas fa-pen-nib me-2"></i>Mode Édition
                </div>
                <h1 class="display-6 fw-black text-dark">{{ person.firstname }} {{ person.lastname|upper }}</h1>
                <p class="text-muted">Mettez à jour les informations de ce membre pour actualiser vos simulations.</p>
            </div>

            {# --- CARTE PRINCIPALE --- #}
            <div class="card border-0 shadow-smooth rounded-5 bg-white mb-5">
                <div class="card-body p-4 p-lg-5">
                    {{ include('family/person/_form.html.twig', {
                        'button_label': 'Enregistrer les modifications',
                        'button_class': 'btn btn-ux-primary w-100 py-3 rounded-4 fw-bold'
                    }) }}
                </div>
            </div>

            {# --- ZONE DE DANGER (Style épuré mais explicite) --- #}
            <div class="danger-zone-clean p-4 rounded-5 border border-danger-light bg-danger-subtle text-center text-md-start">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h6 class="text-danger fw-black mb-1">Zone de danger</h6>
                        <p class="small text-danger opacity-75 mb-0">La suppression effacera définitivement ce membre et ses liens.</p>
                    </div>
                    <div class="col-md-4 text-md-end mt-3 mt-md-0">
                        <button type="button" class="btn btn-white-danger rounded-pill px-4 fw-bold" data-bs-toggle="modal" data-bs-target="#deleteModal">
                            Supprimer la fiche
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{# --- MODAL DE CONFIRMATION (Cohérent avec le nouveau style) --- #}
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-2xl rounded-5 overflow-hidden">
            <div class="modal-body p-5 text-center">
                <div class="icon-pulse-danger mb-4">
                    <i class="fas fa-trash-can"></i>
                </div>
                
                <h3 class="fw-black mb-3">Supprimer {{ person.firstname }} ?</h3>
                <p class="text-muted mb-5">
                    Cette action est irréversible. Toutes les relations et l'historique fiscal de ce membre seront perdus.
                </p>

                <div class="d-grid gap-3">
                    {{ include('family/person/_delete_form.html.twig') }}
                    
                    <button type="button" class="btn btn-link text-secondary text-decoration-none fw-bold" data-bs-dismiss="modal">
                        Annuler, conserver le profil
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --indigo: #4f46e5;
        --indigo-subtle: #f5f7ff;
        --danger-soft: #fff1f2;
        --danger-border: #fecaca;
    }

    .fw-black { font-weight: 850; letter-spacing: -0.02em; }
    
    /* Carte Ombre Douce */
    .shadow-smooth {
        box-shadow: 0 10px 40px -10px rgba(0,0,0,0.05), 0 20px 25px -5px rgba(0,0,0,0.02) !important;
    }

    /* Badge Édition */
    .edit-badge {
        display: inline-flex; align-items: center;
        background: var(--indigo-subtle); color: var(--indigo);
        padding: 6px 16px; border-radius: 99px;
        font-size: 0.8rem; font-weight: 800; text-transform: uppercase;
        border: 1px solid #c7d2fe;
    }

    /* Bouton Principal */
    .btn-ux-primary {
        background: var(--indigo); color: white; border: none;
        box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.3); transition: all 0.3s;
    }
    .btn-ux-primary:hover {
        background: #4338ca; transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4); color: white;
    }

    /* Zone Danger Clean */
    .danger-zone-clean { border: 1px dashed var(--danger-border) !important; background-color: var(--danger-soft); }
    .btn-white-danger { background: white; color: #e11d48; border: 1px solid var(--danger-border); transition: 0.3s; }
    .btn-white-danger:hover { background: #e11d48; color: white; }

    /* Modal Icons & Pulse */
    .icon-pulse-danger {
        width: 80px; height: 80px; background: white; color: #ef4444;
        border-radius: 50%; display: flex; align-items: center; justify-content: center;
        margin: 0 auto; font-size: 2rem; border: 2px solid #fee2e2;
        animation: pulse-red-soft 2s infinite;
    }

    @keyframes pulse-red-soft {
        0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.2); }
        70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); }
        100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
    }

    .hover-translate-x { transition: 0.3s; }
    .hover-translate-x:hover { transform: translateX(-5px); color: var(--indigo) !important; }
    .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15); }
</style>
{% endblock %}