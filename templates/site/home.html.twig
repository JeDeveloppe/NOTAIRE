{% extends 'base.html.twig' %}

{% block body %}
    {# --- DÉGRADÉ DE FOND DYNAMIQUE --- #}
    <div class="bg-glow"></div>

    <div class="container py-4 position-relative">
        
        {# --- 1. HERO SECTION : IMPACT & RASSURANCE --- #}
        <section class="row align-items-center min-vh-75 mb-5 pb-lg-5">
            <div class="col-lg-6 mb-5 mb-lg-0">
                <div class="badge-ux mb-4">
                    <span class="pulse-dot"></span>
                    <span class="small fw-bold">Simulateur d'aide à la décision fiscale</span>
                </div>
                <h1 class="display-3 fw-black text-dark mb-4 ls-tight">
                    Votre héritage mérite <br>
                    <span class="text-indigo-gradient">une stratégie.</span>
                </h1>
                <p class="fs-5 text-secondary mb-5 pe-lg-5">
                    Ne laissez plus vos abattements expirer. Notre algorithme cartographie votre famille pour optimiser chaque euro transmis, **en préparation de votre prochain acte notarié.**
                </p>

                <div class="d-flex flex-wrap gap-3">
                    {% if app.user %}
                        <a href="{{ path('app_family_dashboard') }}" class="btn-ux-primary">
                            <span>Voir mon diagnostic</span> <i class="fas fa-chart-line ms-2"></i>
                        </a>
                    {% else %}
                        <a href="{{ path('app_login') }}" class="btn-ux-primary">
                            <span>Démarrer l'analyse</span> <i class="fas fa-magic ms-2"></i>
                        </a>
                        <a href="{{ path('app_register') }}" class="btn-ux-outline">Créer un compte</a>
                    {% endif %}
                </div>
            </div>
            
            {# --- VISUEL INTERACTIF (MOCKUP 3D) --- #}
            <div class="col-lg-6 d-none d-lg-block">
                <div class="hero-visual-wrapper">
                    <div class="ui-mockup shadow-2xl rounded-5 border bg-white p-4">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <span class="fw-bold h5 mb-0">Transmission Famille</span>
                            <span class="badge bg-indigo-soft text-indigo border-0 px-3">Barème 2025</span>
                        </div>
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="stat-card p-3 rounded-4">
                                    <div class="small text-muted mb-1">Économie estimée</div>
                                    <div class="h3 fw-bold mb-0 text-indigo" id="counter">0 €</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-card p-3 rounded-4">
                                    <div class="small text-muted mb-1">Prochaine purge</div>
                                    <div class="h4 fw-bold mb-0">Juin 2029</div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 p-3 border-dashed rounded-4">
                            <div class="d-flex align-items-center">
                                <div class="icon-circle-sm bg-success text-white me-3">
                                    <i class="fas fa-check"></i>
                                </div>
                                <span class="small fw-bold text-dark">Dossier prêt pour votre notaire</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        {# --- 2. BENTO GRID : L'EXPERTISE EN 3 ÉTAPES --- #}
        <section class="py-5">
            <h2 class="h3 fw-bold text-center mb-5">Comment préparer votre transmission ?</h2>
            <div class="bento-grid">
                <div class="bento-item main-feature shadow-sm">
                    <div class="bento-icon bg-primary-soft text-primary"><i class="fas fa-sitemap"></i></div>
                    <h5>Cartographiez</h5>
                    <p class="text-muted small">Ajoutez vos proches. L'outil détecte automatiquement les liens de parenté et les abattements associés.</p>
                </div>
                <div class="bento-item shadow-sm">
                    <div class="bento-icon bg-warning-soft text-warning"><i class="fas fa-calculator"></i></div>
                    <h5>Simulez</h5>
                    <p class="text-muted small">Testez différents montants de dons et voyez l'impact immédiat sur vos plafonds.</p>
                </div>
                <div class="bento-item shadow-sm">
                    <div class="bento-icon bg-danger-soft text-danger"><i class="fas fa-file-export"></i></div>
                    <h5>Exportez</h5>
                    <p class="text-muted small">Générez un bilan complet à présenter à votre notaire pour finaliser l'acte.</p>
                </div>
            </div>
        </section>

        {# --- 3. SECTION ANALYSE : VISUEL & IMPACT --- #}
        <div class="card border-0 bg-dark rounded-5 p-4 p-lg-5 text-white mb-5 shadow-lg overflow-hidden position-relative">
            <div class="row align-items-center position-relative" style="z-index: 2;">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h2 class="fw-bold mb-4">Ne perdez plus un cycle fiscal.</h2>
                    <p class="text-white-50 fs-5 mb-4">En France, les compteurs se remettent à zéro tous les 15 ans. Ne pas utiliser ses droits, c'est renoncer à transmettre sans impôts.</p>
                    <div class="d-flex flex-column gap-3">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle text-indigo me-3 fs-5"></i>
                            <span>Détection des opportunités manquées</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle text-indigo me-3 fs-5"></i>
                            <span>Alerte de renouvellement des 15 ans</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="image-mockup rounded-4 overflow-hidden border border-secondary shadow">
                        <img src="https://via.placeholder.com/800x450/1a1a1a/444?text=Interface+Optimisation+Fiscale" class="img-fluid" alt="Dashboard">
                    </div>
                </div>
            </div>
            <div class="glow-spot"></div>
        </div>

        {# --- 4. DISCLAIMER JURIDIQUE (ESSENTIEL UX) --- #}
        <div class="text-center py-5">
            <div class="mx-auto" style="max-width: 750px;">
                <div class="mb-3 text-muted">
                    <i class="fas fa-balance-scale fs-3"></i>
                </div>
                <p class="text-muted small">
                    <strong>Note d'usage :</strong> Ce simulateur est un outil informatif basé sur les barèmes fiscaux de 2025. Il ne remplace en aucun cas le conseil juridique. Toute donation doit être validée et enregistrée par un **notaire diplômé** pour être effective.
                </p>
                <a href="https://www.notaires.fr" target="_blank" class="btn btn-link text-decoration-none text-indigo fw-bold">
                    Trouver un notaire à proximité <i class="fas fa-external-link-alt ms-1"></i>
                </a>
            </div>
        </div>
    </div>

    <style>
        :root {
            --indigo: #4f46e5;
            --indigo-soft: #eef2ff;
            --dark: #0f172a;
        }

        .fw-black { font-weight: 900; }
        .ls-tight { letter-spacing: -0.025em; }
        .text-indigo { color: var(--indigo); }
        .bg-indigo-soft { background-color: var(--indigo-soft); }
        .text-indigo-gradient { background: linear-gradient(45deg, var(--indigo), #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* HERO & BUTTONS */
        .badge-ux { display: inline-flex; align-items: center; background: white; border: 1px solid #e2e8f0; padding: 6px 16px; border-radius: 99px; }
        .pulse-dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; margin-right: 12px; animation: pulse 2s infinite; }
        
        .btn-ux-primary { background: var(--dark); color: white; padding: 16px 32px; border-radius: 16px; text-decoration: none; font-weight: 600; transition: all 0.3s; display: inline-block; }
        .btn-ux-primary:hover { background: #334155; transform: translateY(-3px); color: white; }
        .btn-ux-outline { background: white; border: 1px solid #e2e8f0; color: var(--dark); padding: 16px 32px; border-radius: 16px; text-decoration: none; font-weight: 600; transition: all 0.3s; display: inline-block; }
        .btn-ux-outline:hover { background: #f8fafc; transform: translateY(-3px); }

        /* MOCKUP 3D EFFECT */
        .hero-visual-wrapper { perspective: 1000px; }
        .ui-mockup { transform: rotateY(-10deg) rotateX(5deg); transition: transform 0.5s; }
        .ui-mockup:hover { transform: rotateY(0deg) rotateX(0deg); }
        .stat-card { background: #f8fafc; border: 1px solid #f1f5f9; }
        .icon-circle-sm { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; }

        /* BENTO GRID */
        .bento-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .bento-item { background: white; border-radius: 24px; padding: 2rem; border: 1px solid #f1f5f9; transition: all 0.3s; }
        .bento-item:hover { transform: translateY(-8px); border-color: var(--indigo); }
        .bento-icon { width: 50px; height: 50px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; margin-bottom: 1.5rem; }
        .bg-primary-soft { background: #eff6ff; }
        .bg-warning-soft { background: #fffbeb; }
        .bg-danger-soft { background: #fef2f2; }

        /* MISC */
        .bg-glow { position: absolute; top: 0; right: 0; width: 50vw; height: 50vh; background: radial-gradient(circle, rgba(79, 70, 229, 0.05) 0%, transparent 70%); z-index: -1; }
        .glow-spot { position: absolute; bottom: -20%; left: -10%; width: 400px; height: 400px; background: var(--indigo); filter: blur(120px); opacity: 0.1; }
        .border-dashed { border: 2px dashed #e2e8f0; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); } 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); } }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const counter = document.getElementById('counter');
            const target = 31865;
            let current = 0;
            const step = target / 60;
            const update = () => {
                current += step;
                if (current < target) {
                    counter.innerText = Math.floor(current).toLocaleString() + ' €';
                    requestAnimationFrame(update);
                } else {
                    counter.innerText = target.toLocaleString() + ' €';
                }
            };
            setTimeout(update, 500);
        });
    </script>
{% endblock %}